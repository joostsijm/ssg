<!DOCTYPE html>
<html>
<head>
    <title>Backend</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="/static/js/main.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarsDefault">
            <ul class="navbar-nav mr-auto">
                {%- for item in current_menu.children recursive -%}
                <li class="nav-item {{ 'active' if item.active }}" data-toggle="tooltip" data-placement="right" title="{{ item.text }}">
                    <a class="nav-link" href="{{ item.url}}">
                        <span class="nav-link-text">{{ item.text }}</span>
                    </a>
                </li>
                {%- endfor -%}
            </ul>
            <ul class="navbar-nav">
                <li class="nav-item text-nowrap">
                      <a class="nav-link" href="#">Sign out</a>
                </li>
            </ul>
        </div>
    </nav>
    <main class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
        <h1>Backend</h1>
        <h1>Bootstrap starter template</h1>
        <p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.</p>
        <div class="table-responsive">
            <table class="table table-striped table-sm">
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>Title</th>
                        <th>Datum</th>
                        <th>Author</th>
                    </tr>
                </thead>
                <tbody>
                    {%- for page in pages recursive -%}
                    <tr>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Small button
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" href="{{ url_for('backend.view_page', page_id=page.id) }}">View</a>
                                    <a class="dropdown-item" href="{{ url_for('backend.edit_page', page_id=page.id) }}">Edit</a>
                                    <a class="dropdown-item" href="{{ url_for('backend.remove_page', page_id=page.id) }}">Remove</a>
                                </div>
                            </div>
                        </td>
                        <td>
                            {{ '> ' * (loop.depth - 1) }}<a href="{{ url_for('backend.view_page', page_id=page.id) }}">
                                {{ page.title if page.title else 'page %s' % page.id }}
                            </a>
                        </td>
                        <td>{{ page.datetime }}</td>
                        <td>{{ page.user.name }}</td>
                    </tr>
                    {{ loop(page.children) }}
                    {%- endfor -%}
                </tbody>
            </table>
        </div>
    </main>
</body>
